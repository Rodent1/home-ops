---
version: '3'

tasks:
  down:
    desc: Scale down the apps requiring postgres
    cmds:
      - kubectl scale deployment/atuin --replicas=0 -n system
      - kubectl scale deployment/ak-outpost-ldap --replicas=0 -n security
      - kubectl scale deployment/authentik-server --replicas=0 -n security
      - kubectl scale deployment/authentik-worker --replicas=0 -n security
      - kubectl scale deployment/coder --replicas=0 -n dev
      - kubectl scale deployment/gatus --replicas=0 -n monitoring
      - kubectl scale statefulset/home-assistant --replicas=0 -n default
      - kubectl scale deployment/immich-web --replicas=0 -n default
      - kubectl scale deployment/immich-machine-learning --replicas=0 -n default
      - kubectl scale deployment/immich-server --replicas=0 -n default
      - kubectl scale deployment/immich-microservices --replicas=0 -n default
      - kubectl scale statefulset/immich-typesense --replicas=0 -n default
      - kubectl scale deployment/prowlarr --replicas=0 -n media
      - kubectl scale deployment/radarr --replicas=0 -n media
      - kubectl scale deployment/sonarr --replicas=0 -n media

  up:
    desc: Scale up the apps requiring postgres
    cmds:
      - kubectl scale deployment/atuin --replicas=1 -n system
      - kubectl scale deployment/ak-outpost-ldap --replicas=1 -n security
      - kubectl scale deployment/authentik-server --replicas=1 -n security
      - kubectl scale deployment/authentik-worker --replicas=1 -n security
      - kubectl scale deployment/coder --replicas=1 -n dev
      - kubectl scale deployment/gatus --replicas=1 -n monitoring
      - kubectl scale statefulset/home-assistant --replicas=1 -n default
      - kubectl scale deployment/immich-web --replicas=2 -n default
      - kubectl scale deployment/immich-machine-learning --replicas=1 -n default
      - kubectl scale deployment/immich-server --replicas=2 -n default
      - kubectl scale deployment/immich-microservices --replicas=2 -n default
      - kubectl scale statefulset/immich-typesense --replicas=1 -n default
      - kubectl scale deployment/prowlarr --replicas=1 -n media
      - kubectl scale deployment/radarr --replicas=1 -n media
      - kubectl scale deployment/sonarr --replicas=1 -n media
